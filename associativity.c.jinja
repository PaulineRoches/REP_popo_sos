#include <stdio.h>
#include <stdlib.h>
#include <time.h>

void aleatoire({{type_choice}} *x, {{type_choice}} *y, {{type_choice}} *z) {
    // Générer trois chiffres aléatoires entre -100 et 100
    *x = (({{type_choice}}){{ random_choice }}) * {{max_choice}} - {{min_choice}}; 
    *y = (({{type_choice}}){{ random_choice }}) * {{max_choice}} - {{min_choice}};
    *z = (({{type_choice}}){{ random_choice }}) * {{max_choice}} - {{min_choice}};
}


void ecrireResultats(int totalExperiences, int associativiteVerifiee, double tauxAssociativite) {
    /*FILE *fichier = fopen("answer_associativity.txt", "w");
    if (fichier == NULL) {
        perror("Erreur lors de l'ouverture du fichier");
        return;
    }*/

    //fprintf(fichier, "Sur %d expériences, l'associativité a été vérifiée %d fois.\n", totalExperiences, associativiteVerifiee);
    //fprintf(fichier, "Le taux d'associativité est de %.2f%%.\n", tauxAssociativite);
    //fprintf(fichier, "%.2f", tauxAssociativite);
    //fclose(fichier);
    printf("%.2f\n", tauxAssociativite);
}

void calculerTauxAssociativite(int totalExperiences) {
    {{type_choice}} x, y, z;
    int associativiteVerifiee = 0;

    // Exécuter lexpérience un certain nombre de fois
    for (int i = 0; i < totalExperiences; i++) {
        aleatoire(&x, &y, &z);

        // Calculer les résultats
        {{type_choice}} res1 = (x + y) + z;
        {{type_choice}} res2 = x + (y + z);

        // Vérifier l'associativité
        if (res1 == res2) {
            associativiteVerifiee++;
        }
    }

    // Calculer le taux d'associativité
    double tauxAssociativite = (double)associativiteVerifiee / totalExperiences * 100;

    ecrireResultats(totalExperiences, associativiteVerifiee, tauxAssociativite);
}

int main() {
    {{type_choice}} x, y, z;
    int version = 0;

    // Initialiser le générateur de nombres aléatoires
    srand(time(NULL));

    int totalExperiences=50000;

    calculerTauxAssociativite({{num_exp}});
    
    return 0;
}